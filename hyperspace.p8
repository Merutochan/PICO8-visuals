pico-8 cartridge // http://www.pico-8.com
version 19
__lua__
n = 200
pi = 3.141592

function _init()
	cls()
	t = 0
	balls = {}
	for i=1, n do
	 add_ball(balls)
	end
end

function add_ball(l)
	b = {}
	b.x = 63
	b.y = 63
	b.z = flr(rnd(3))
	b.c = flr(rnd(15))
	speed = rnd(0.1)
	b.fx = speed
	b.fy = speed
	b.fz = speed
	dx = ((-1+rnd(2)))*2
	dy = ((-1+rnd(2)))*2
	b.ax = dx*rnd(1.5)
	b.ay = dy*rnd(1.5)
	add(l, b)
end
	
function _update60()

	foreach(balls, ball_trajectory)
	order_z(balls)
	t+= 1/6
	
end

function order_z(l)

 for i=1,#l do
 	local j = i
  while j > 1 and l[j-1].z > l[j].z do
  	l[j],l[j-1] = l[j-1],l[j]
   j = j - 1
  end
	end
end


function ball_trajectory(b)
	b.x += b.ax
	b.y += b.ay
	b.z += 0.1*sin(b.fz*t)
	if b.z < 0 then b.z = 0 end
	if (b.x < -b.z or b.x > 127+b.z or 
				b.y < -b.z or b.y > 127+b.z) then
				del(balls, b)
				add_ball(balls)
	end
				
end	
	
function draw_ball(b)
	circfill(b.x, b.y, b.z, b.c)
	circ(b.x,b.y,b.z,flr(rnd(15)))
end

function _draw()
	cls()

	foreach(balls, draw_ball)

end


__label__
00000000000000000000000000000000007000004555400000000000000000aaa000044400000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000007170000455540000000000000000abbba00000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000700000455540000000000000000abbba00000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000044400000000000000000abbba00000000000000000000000000000000000000000000000000000000000000
000000000000000000000000e0000000000000000000000000000000000000aaa000000000000000000000000222220000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000002777772000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000027777777200000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000277777777720000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000002777777777772000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000002000000000000000000002777777777772000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000028200000000000000000002777777777772000000000000666000000000000000
00000000000000000000000000000000000000000000000000000000000000002000000000000000000002777777777772000000000006555600000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000002777777777772000000000006555600000000000000
00000000000000000000000000000000000000000000000044400000000000000000000000000000000000277777777720000000000006555600000000000000
00000000000000000000000000000000000000000500000466640000000000000000000000000000000000027777777200000000000000666000000000000000
00000000111000000000000000000000000000000000000466640000000000000000000000000000000000002777772000000000000000000000000000000000
00000001999100000000000000000000000000e00000000466640000000000000000000000000000000000000222220000000000000000000000000000000000
0000000199910000000000000000000000000000000000004440000000000000000000eeeee00000000000000000000000000000000000000000000000000000
000000019991000000000000000000000000000000000000000000000000000000000e22222e0000000000000000000000000000000000000000000000000000
00000000111000000000000000000000000000000000000002000000000000000000e2222222e000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000d000000000000000000000000000000e222222222e00000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044400000009000000ee22222222222e0000000004000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000044444000000000000e8e22222222222e0eeeee0000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000004444444000000000000ee22222222222eeeeeeee000666000000000000000000000000000000000000
000000000000000000000000000000000a000000c0000044444440000444000000e22222222222eeeeeeee066111660000000000000000000000000000000000
000000000000000000000000000000000000000000000044444440004bbb400000e22222222222eeeeeeee061111160000000000000000000000000000000000
000000000000000000000000000000000000000000000004444400004bbb4000000e222222222eeeeeeeee611111116000000000000000000000000000000000
000000000000000000000000000000000000000000000000444000004bbb40000000e2222222eeeeeeeeee611111116000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000444000000000e22222ee0eeeeeee0611111116000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000006000eeeee000eeeeeee0061111160000000000000000000050000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000eee000066111660000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000666000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000bbb0000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000
000000000bcccb000000000000000000000000000000000000000000000003333300000000000000000000000000000000000000000000000000000000000000
00000000bcccccb00000000000000000008000000000000000000000000030000030000000000000000000000000000000000000000000000000000000000000
00000000bcccccb00000000c00000000000000000000000000000000000300000003888000000000000000000000000000000000000000000000000000000000
00000000bcccccb000000000000000000000000000000000000000000030000000003ee880000000000000000000000000000000000000000000000000000000
000000014bcccb0000000000000000000000000000000000000000000030000000003eee80000000000000000000000000000000000000000000000000000000
0000000144bbb10000000000000000000000000000000000000000000030000000003eeee8000000000000000000000000000000000000000000000000000000
000000014444410000000000000000000000000000000000000000003330000000003eeee8000000000000ccc000000000000000000000000000030000000000
000000001444100000000000000000000000000000000000000070033330000000003eeee80000000000cc777cc0000000000050000000000000000000000000
00000000011100000000000000000000000000000000000000006633333300000003eeee800000000000c77777c0000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000006ee33333330000038eee880000000000c5557777c000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000006ee333333333333008880000000000055bbb5577c000000000000000000000000000000044400
0000000000000000000000000222000000000000033300000006eee3333300000000000000000000005bbbbb577c000000000000000000000000000000477740
0000000000000000000000002999200000000000311130000000666033300000000d00000000000005bbbbbbb5c0000000000000000000000000000000477740
0000000000000000000000002999200000000000311130000200000000000500000000000000000005bbbbbbb5c0000000400000000000000000000000477740
0000000000000000000000002999200000000000311130002920003000005050000000000000000005bbbbbbb500000004340000000000000000000000044400
00000000000000000000000002220000000000000333000002000377700005000300000009000000005bbbbb5000000000400000000000000000000000000000
000000000000000000000000000000000000000000000000000007333700000000000040000000000055bbb550000000000b0000000000000000000000000000
0000000000000000000000000000000000000000400000000000073337000000009990000000000008c8555bbbbb000000000000009990000000007770000000
00000000000000000000000000000000000000000000000000000733370000000900090000000000008000b88888b00000000000096669000000073337000000
0000000000000000000000000000000000000000000000000000007770500000090009000000000000055b8888888b000000000a096669000000733333700000
000000000000000000000000000000000077700000000000000000000000000009000900700070000050b888888888b000000000096669000000733333700000
00000000000000000000000000000000076667000000000000000000003c0000009990071707b700005b88888888888b00000000009990000000733333700000
0000000000000000006660000000000076666670000000000c000000033300000003000070007000005b88888888888b00000000000000000000073337000000
000000000000000000666000000005007666667000000000c1c10000003000006000000000000000000b88888888888b00000000000000000000007770000000
00000000000000000066600000006000766666700000000ddddd000000000000a000090000000000000b88888888888b00000000000000000000000000000000
0000000000000000000000000000000007666700000000dcccccd000000000088800949000000000000b88888888888b00000000000000000000000000000000
000000000000000000000000000000000077706660000dcccccccd000000708777800900000000000000b888888888b0000000000000000c0000000000000000
00000000022200000000000000000000000006bbb600dcccccccccd000075557777800000000000000000b8888888b0000000000000000000000000000000000
000ddd00288820000000000000000000000006bbb600dcccccccccd00055bbb55778000111000000000000b88888b00000000000000000000000000000000000
00dcccd288888200000000000000000000a006bbb600dcccccccccd0005bbbbb57780017771000000000000bbbbb000000000000000000000000000000000000
00dcccd28888820000000000000000000aca00666000dcccccccccd005bbbbbbb58201777771040000000000000000d000000000000000000000000000000000
00dcccd288888200000070000000000000a000000000dcccccccccd005bbbbbbb5662177777100000000000000000d3d00000000000000000000000000000000
000ddd0028882000000000000b0000000000000000000dcccccccd0005bbbbbbb56661777771000000000000100000d000000000000000000000000000000000
0000000002220000000000000000000000000000006000dcccccd000005bbbbb5666621777100000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000ddddd00000055bbb55666620111000000000000000000000000000000000000000000000000000000
00000000000000a00000000000000000000000000000000000000000008855512666200000000000000001000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000008ccc8811222000000000000000000000000000000000000000000000000000000000000
660000000000000000000000000000000000000000000000000a000008ccc88111800000000a0000000000000000000000000000000000000000001111100000
6660000000000000000000000000000000300000000000000000000008ccc8088800000000444440000000000000000000000000000000000000018888810000
66600000000000000000000000000000000000000000000000000000008880000000000004ccccc4000000000000000000000000e00000000000188888881000
66600000000020000000000000000000000000000000000000000000000000bbb00000004ccccccc407000000000000000000000000000000001888888888100
6600000000000000000000000000000000000000000000000000000000000b111b000004ccccccccc4b700000000000000000000000000000001888888888100
00000000000000000000000000000000000000000000000000000000000788811b000004ccccccccc47000000000000000000000000000000001888888888100
00000000000000000000000000000000000000000000000000000000007822281b000004ccccccccc40000000000000000000000000000000001888888888100
00000000000000000000000000000000000000000000000000000000008222228e030004ccccccccc40000000000000000000000000000000001888888888100
000000000000000000004000000000000000000000000000000000000082222285eb3004ccccccccc40000000000000000000000000000000000188888881000
00000000000000000004e4000000000000000000000000000000000000822222855e00004ccccccc494000000000000000000000000000000000018888810000
000000000000000000004000000000000000000000000600000000000b082228555e000004ccccc4994000000000000000000000000000000000001111100000
0000000000000000000000000000000011100000000069600000000000008885555e000000444449994000000000000000000000000000000000000000000000
00000000000000000000000000000001aaa100000000060000000000000900e555e0000001149999940000000000033300000000000000000000000000000000
00000010000000000000000000000001aaa10c0000000000000000000000000eee4a0000100449994400000000003bbb30000000000000000000000000000000
00000000000000000000000000000001aaa1000000000000000000000000000a444a000100000444000000000003bbbbb3000000000000000000000000000000
000000000000000000000000000000001110000000000000000000000000000a444a000100000100000000000003bbbbb3000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000aaa0000100000100000000000003bbbbb3000000000000000000000000000000
000000000000000000000000000000000000000000900000066600000000000000000000100010000000000000003bbb30000000000000000000000000000000
00000000000000000000000000000000000000000929000069996000000000000000000001110000000000000000033300000000000000000000000000000000
00000000000000000000000000000000000000000090000069996000000000000000555000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000069996000000000000055555550000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000006660000003333300055555550000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000500000000000034444430555555555000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000005350000000000344444443555555555000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000005000000000034444444443555555550000000000000000000000aaa00000000000000000000000000000
00000000000000000000000c00000000000000000000000000000003444444444355555550000000000000000000000abbba0000000000000000000000000000
0000002000000000000000000000000000000000000000000000000344444444435555555000000000000000000500abbbbba000000000000000000000000000
0000022200000000000000000000000000000000000000000000000344444444431155500000000c00000000000000abbbbba000000000000000000000000000
0000002000000000000000000000000000000000000000000000000344444444436660b0000000c0c00000000000333bbbbba000000000000000000000000000
0000000000000000000000000000000000000000000000000000000034444444300000000000000c000000000003aaa3bbba000000000b000000000000000000
0000000000000000000000900000000000000000000000000004444403444443000000000000000000000000003aaaaa3aa000000000b7b00000000000000000
0000000000000000000000000050000000000000000000000043333340333330000000000000000000000000003aaaaa3000000000000b000000000000000000
0000000000000000000000000535000000000000000000000433333334000000000000000000000000000000003aaaaa30000000000000000000000000000000
00000000000000000000000000500000000000000000000043333333338888800000000000000000000000000003aaa300000000000000000000000000000000
00000000000000000000000000000000000000000000000043333333889999988000000000000000000000000000333000000000000000000000000000000000
00000000000000000000000000000000000000000000000043333338999999999800000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000043333389999999999980000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000043333389999999999980000000000000000000000000000000000000000000000000000000000005
0000000000000000000000000000000000000000000000000433389999999999999800000000000000000000000000000000000000000000000000000000005a
00000000000000000000000000000000000000000000000000433899999999999998000000000000000000000000000000000000000000000000000000000005
00000000000000000000000000000000000000000000000000044899999999999998000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000010000000000000000000000899999999999998000000000000000000000000000000000000000000000000000000000000
0000c000000000000000000000000000000000000000000000000899999999999998000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000089999999999980000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000089999999999980000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000008999999999800000000000000055500000000000000000000000000000000000000000000
00000000000000000000000000555550000000000000000000000000889999988000000000000000999b50000000000000000000000000000000000000000000
0000000000000000000000000555555500000000bbb0000000000000008888800000000000000099999990000000b00000000000000000000000000000000000
000000000000000000000000555555555000000bcccb000000000000000000000000000000000099999990000000000000000000000000000000000000000000
00000000000000000000000555555555550000bcccccb00000000000000000000000000000000999999999000000000000000000000000000000000000000000
00000000000000000000005555555555555000bcccccb00000000000000000000000000000000999999999000000000000000000000000000000000000000000
00000000000000000000005555555555555000bcccccb00000000000000000000000000000000999999999000000000000000000000000000000000000000000
000000000000000000000055555555555550000bcccb000000000000000000000000000000000099999990000000000000000000000000000000000000000000
00000aaa00000000000000555555555555500000bbb0000000000000000000000000000000000099999990000000000000000000000000000000000000000000
00000aaa000000000000005555555555555000000000000000000000000000000000000000000000999000000000000000000000000000000000000000000000
00000aaa000000000000000555555555550000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000055555555500000000000000000000000000074700000000000000000000000000000000000000000000000000000000000000000

