pico-8 cartridge // http://www.pico-8.com
version 19
__lua__
sq = 128*sqrt(2)
sw2=false
function _init()
	cn=0
	n=3+flr(rnd(32))
	lst={0,5,6,7}
	m=4
	spd=4+rnd(8)
	t = {}
	for i = 0, n do
		add(t, p(i))
	end
	cx=64
	cy=64
	cr={}
	for i=0, m do
		add(cr, q(128/m*i))
	end
end


function _update60()
	foreach(t, up)
	if btn(5) then
		_init()
	end
	for i=1,#cr do
		cr[i].r += cr[i].s
		if cr[i].r>sq then
			del(cr,cr[i])
			add(cr, q(0))
		end
	end
	if btnp(2) then
		cn=(cn+1)%4
		poke(0x5f2c, lst[cn+1])
	end
	if btnp(3) then
		sw2 = not sw2
	end
	
	cx+=cos(time()/8)
	cy+=sin(time()/3)
end


function _draw()
	cls()
	-- bg1
	if not btn(4) then
 	if flr(time()*2)%2==0 then
 		pal(10,flr(time()))
 		for i=0,8 do
 			for j=0,8 do
 				sspr(0,0,8,8,i*16,j*16,(8*i%2)+16*abs(cos(time()/spd)),(8*j%2)+16*abs(cos(time()/spd)))
 				sspr(0,0,8,8,8+i*16,8+j*16,(8*i%2)+16*abs(cos(time()/spd)),(8*j%2)+16*abs(cos(time()/spd)))
 			end
 		end
 	end
 end
 
 if not (btn(4) and sw2) then
 	-- circles
 	for i=1,#cr do
 		circ(cr[i].x, cr[i].y, cr[i].r, 7)
 	end
 	circfill(cx,cy,8,0)
 end
	if flr(time()*15)%15<2 then
		cls(7)
	end
	-- curve
	if flr(time()*spd)%2==0 then
		--cl = flr(16*cos(time()/128))
		cl = 7
 	for i=1,#t do
 		if i==#t then
 			line(t[i].x,t[i].y,t[1].x,t[1].y,cl)
 		else
 			line(t[i].x,t[i].y,t[i+1].x,t[i+1].y,cl)
 		end
 	end
 end
end

function p(i)
	po={}
	po.x = 64-48+rnd(96)
	po.y = 64-48+rnd(96)
	po.i = i
	return po
end

function up(p)
	p.x += rnd(0.3)*cos(time()/spd+p.i/#t)--+rnd(2)-1
	p.y += rnd(0.3)*cos(time()/spd+p.i/#t)--+rnd(2)-1
end

function q(r)
	ci={}
	ci.x=cx
	ci.y=cy
	ci.r=r
	ci.s=1+rnd(2)
	return ci
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000aa000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001aa100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0aa77aa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0aa77aa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001aa100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000aa000000000220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211122220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111122220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111112220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111111122220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111111111122000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111111111120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111111111200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111111112000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111111120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111111200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111112000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111111200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111112000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211111200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211112000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000211200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000212000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000070000000000007000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000077000077000077000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000700700700700700700000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000700777000077700700000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000777000770000007700077700000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000077007077007000070077070077000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000077700070770000700700007707000777000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000077700000077007000700700070077000000777000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000007700000000700000700077000700000700000000770000000000000000000000000000000000000000000
00000000000000000000000000000000000000007770000000077700000070000007000000777000000007770000000000000000000000000000000000000000
00000000000000000000000000000000000000770000000000707000000007700770000000070700000000007700000000000000000000000000000000000000
00000000000000000007000000000000000777000000000077007000000000077000000000070077000000000077700000000000000070000000000000000000
00000000000000000007700000000000777000000000000700070000000000000000000000007000700000000000077700000000000770000000000000000000
00000000000000000007700000000077000000000000077000070000000000000000000000007000077000000000000077000000000770000000000000000000
00000000000000000007070000077700000000000000700000070000000000000000000000007000000700000000000000777000007070000000000000000000
00000000000000000007007007700000000000000077000000700000000000000000000000000700000077000000000000000770070070000000000000000000
00000000000000000007007770000000000000000700000000700000000000000000000000000700000000700000000000000007770070000000000000000000
00000000000000000007770700000000000000007000000007000000000000000000000000000070000000070000000000000000707770000000000000000000
00000000000000000777000700000000000000770000000007000000000000000000000000000070000000007700000000000000700077700000000000000000
00000000000000777007000070000000000007000000000070000000000000000000000000000007000000000070000000000007000070077700000000000000
00000000000077000007000007000000000770000000000070000000000000000000000000000007000000000007700000000070000070000077000000000000
00000000007777777707000007000000007000000000000700000000000000000000000000000000700000000000070000000070000070777777770000000000
00000000000000000077777777777777770000000000000700007000000000000000000000070000700000000000007777777777777777000000000000000000
00000000000000000007000000070007077777777000007000007000000000000000000000070000070000077777777070007000000070000000000000000000
00000000000000000007000000070770000000007000007000000700000000000000000000700000070000070000000007707000000070000000000000000000
00000000000000000007000000007777000000070000070000000700000000000000000000700000007000007000000077770000000070000000000000000000
00000000000000000007000000007000777777070000070000000770000000777700000007700000007000007077777700070000000070000000000000000000
00000000000000000007000000000700000000777777700000000070000077000077000007000000000777777700000000700000000070000000000000000000
00000000000000000007000000000070000000700700777777000077007700000000770077000077777700700700000007000000000070000000000000000000
00000000000000000007000000000070000000707070700000777777770000000000007777777700000707070700000007000000000070000000000000000000
00000000000000000007000000000007000000707077000000000007777777000077777770000000000077070700000070000000000070000000000000000000
00000000000000000007000000000000700007070007000000000077700000777700000777000000000070007070000700000000000070000000000000000000
00000000000000000007000000000000700007700070700000007700707777777777770700770000000707000770000700000000000070000000000000000000
00000000000000000007000000000000070007700070070007777777770000000000007777777770007007000770007000000000000070000000000000000000
00000000000000000007000000000000070077077777777770700000770000000000007700000707777777777077007000000000000070000000000000000000
00000000000000000007000000000000007777700700007007000000077000000000077000000070070000700777770000000000000070000000000000000000
00000000000000000007000000000000000777777000000770000000077000000000077000000007700000077777700000000000000070000000000000000000
00000000000000000070000000000000000700007770000770000000007700000000770000000007700007770000700000000000000007000000000000000000
00000000000000000070000000000000007770070007777070000000007700000000770000000007077770007007770000000000000007000000000000000000
00000000000000000070000000000000007707070000070777000000007700000000770000000077707000007070770000000000000007000000000000000000
00000000000000000070000000000000077007700000700000777700000770000007700000777700000700000770077000000000000007000000000000000000
00000000000000000070000000000000707000700000700000700077770770000007707777000700000700000700070700000000000007000000000000000000
00000000000000000070000000000000707000770007000000070000007777000077770000007000000070007700070700000000000007000000000000000000
00000000000000000070000000000007070007007070000000007000000077777777000000070000000007070070007070000000000007000000000000000000
00000000000000000070000000000070070007007700000000000700777777777777777700700000000000770070007007000000000007000000000000000000
00000000000000000070000000000070070070000700007777777777000007700770000077777777770000700007007007000000000007000000000000000000
00000000000000000070000000000700070070007777770000000070000007700770000007000000007777770007007000700000000007000000000000000000
00000000000000000070000000007000700700007070007777777777000007077070000077777777770007070000700700070000000007000000000000000000
00000000000000000070000000070000700700070007000000000000777777777777777700000000000070007000700700007000000007000000000000000000
00000000000000000070000000070000707000070000700000000000700000700700000700000000000700007000070700007000000007000000000000000000
00000000000000000070000000700007007000700000700000000000070000700700007000000000000700000700070070000700000007000000000000000000
00000000000000000070000007000007070000700000070000000000007000077000070000000000007000000700007070000070000007000000000000000000
00000000000000000070000007000007070000700000070000000000007000077000070000000000007000000700007070000070000007000000000000000000
00000000000000000070000000700007007000700000700000000000070000700700007000000000000700000700070070000700000007000000000000000000
00000000000000000070000000070000707000070000700000000000700000700700000700000000000700007000070700007000000007000000000000000000
00000000000000000070000000070000700700070007000000000000777777777777777700000000000070007000700700007000000007000000000000000000
00000000000000000070000000007000700700007070007777777777000007077070000077777777770007070000700700070000000007000000000000000000
00000000000000000070000000000700070070007777770000000070000007700770000007000000007777770007007000700000000007000000000000000000
00000000000000000070000000000070070070000700007777777777000007700770000077777777770000700007007007000000000007000000000000000000
00000000000000000070000000000070070007007700000000000700777777777777777700700000000000770070007007000000000007000000000000000000
00000000000000000070000000000007070007007070000000007000000077777777000000070000000007070070007070000000000007000000000000000000
00000000000000000070000000000000707000770007000000070000007777000077770000007000000070007700070700000000000007000000000000000000
00000000000000000070000000000000707000700000700000700077770770000007707777000700000700000700070700000000000007000000000000000000
00000000000000000070000000000000077007700000700000777700000770000007700000777700000700000770077000000000000007000000000000000000
00000000000000000070000000000000007707070000070777000000007700000000770000000077707000007070770000000000000007000000000000000000
00000000000000000070000000000000007770070007777070000000007700000000770000000007077770007007770000000000000007000000000000000000
00000000000000000070000000000000000700007770000770000000007700000000770000000007700007770000700000000000000007000000000000000000
00000000000000000007000000000000000777777000000770000000077000000000077000000007700000077777700000000000000070000000000000000000
00000000000000000007000000000000007777700700007007000000077000000000077000000070070000700777770000000000000070000000000000000000
00000000000000000007000000000000070077077777777770700000770000000000007700000707777777777077007000000000000070000000000000000000
00000000000000000007000000000000070007700070070007777777770000000000007777777770007007000770007000000000000070000000000000000000
00000000000000000007000000000000700007700070700000007700707777777777770700770000000707000770000700000000000070000000000000000000
00000000000000000007000000000000700007070007000000000077700000777700000777000000000070007070000700000000000070000000000000000000
00000000000000000007000000000007000000707077000000000007777777000077777770000000000077070700000070000000000070000000000000000000
00000000000000000007000000000070000000707070700000777777770000000000007777777700000707070700000007000000000070000000000000000000
00000000000000000007000000000070000000700700777777000077007700000000770077000077777700700700000007000000000070000000000000000000
00000000000000000007000000000700000000777777700000000070000077000077000007000000000777777700000000700000000070000000000000000000
00000000000000000007000000007000777777070000070000000770000000777700000007700000007000007077777700070000000070000000000000000000
00000000000000000007000000007777000000070000070000000700000000000000000000700000007000007000000077770000000070000000000000000000
00000000000000000007000000070770000000007000007000000700000000000000000000700000070000070000000007707000000070000000000000000000
00000000000000000007000000070007077777777000007000007000000000000000000000070000070000077777777070007000000070000000000000000000
00000000000000000077777777777777770000000000000700007000000000000000000000070000700000000000007777777777777777000000000000000000
00000000007777777707000007000000007000000000000700000000000000000000000000000000700000000000070000000070000070777777770000000000
00000000000077000007000007000000000770000000000070000000000000000000000000000007000000000007700000000070000070000077000000000000
00000000000000777007000070000000000007000000000070000000000000000000000000000007000000000070000000000007000070077700000000000000
00000000000000000777000700000000000000770000000007000000000000000000000000000070000000007700000000000000700077700000000000000000
00000000000000000007770700000000000000007000000007000000000000000000000000000070000000070000000000000000707770000000000000000000
00000000000000000007007770000000000000000700000000700000000000000000000000000700000000700000000000000007770070000000000000000000
00000000000000000007007007700000000000000077000000700000000000000000000000000700000077000000000000000770070070000000000000000000
00000000000000000007070000077700000000000000700000070000000000000000000000007000000700000000000000777000007070000000000000000000
00000000000000000007700000000077000000000000077000070000000000000000000000007000077000000000000077000000000770000000000000000000
00000000000000000007700000000000777000000000000700070000000000000000000000007000700000000000077700000000000770000000000000000000
00000000000000000007000000000000000777000000000077007000000000077000000000070077000000000077700000000000000070000000000000000000
00000000000000000000000000000000000000770000000000707000000007700770000000070700000000007700000000000000000000000000000000000000
00000000000000000000000000000000000000007770000000077700000070000007000000777000000007770000000000000000000000000000000000000000
00000000000000000000000000000000000000000007700000000700000700077000700000700000000770000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000077700000077007000700700070077000000777000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000077700070770000700700007707000777000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000077007077007000070077070077000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000777000770000007700077700000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000700777000077700700000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000700700700700700700000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000077000077000077000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000070000000000007000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

